# 🔧 PuzzleCraft AI - 환경설정 업데이트 가이드

## 📋 **개요**

이 문서는 PuzzleCraft AI 프로젝트의 nginx 설정, .gitignore 파일, 그리고 환경 변수 설정을 실제 운영 환경에 맞춰 업데이트한 내용을 설명합니다.

## 🌐 **Nginx 설정 업데이트**

### **주요 변경사항**

1. **실제 운영 구성 반영**
   - Bastion 서버 (puzzle.novelike.dev) → Main 서버 (10.0.3.153) 구조
   - 실제 작동하는 nginx 설정을 문서에 반영

2. **업데이트된 엔드포인트 지원**
   - `/api/v1/puzzles/analyze/complexity`
   - `/api/v1/puzzles/generate-intelligent`
   - `/api/v1/puzzles/status/{task_id}`
   - `/api/v1/puzzles/result/{task_id}`

3. **한국어 문서화**
   - 모든 설정에 한국어 설명 추가
   - 실제 사용 중인 설정 기반으로 문서 작성

### **파일 위치**
- `nginx_configuration.md` - 업데이트된 nginx 설정 가이드

## 📁 **.gitignore 파일 개선**

### **주요 개선사항**

1. **포괄적인 패턴 추가**
   - 🌐 Frontend (React/Vite/Node.js)
   - 🐍 Python Backend
   - 🤖 AI/ML 특화 파일들
   - 🗄️ 데이터베이스 파일들
   - 📁 프로젝트 특화 파일들
   - 💻 OS별 파일들
   - 🔧 개발 도구들
   - 🚀 배포 관련 파일들
   - 🔒 보안 관련 파일들

2. **AI/ML 프로젝트 특화**
   ```gitignore
   # 모델 파일
   *.pkl, *.h5, *.pth, *.onnx
   
   # 데이터셋
   *.csv, *.json, data/, datasets/
   
   # 체크포인트
   checkpoints/, weights/, models/
   ```

3. **프로젝트 특화 패턴**
   ```gitignore
   # 업로드 디렉토리
   uploads/, temp/, tmp/
   
   # SSL 인증서
   *.pem, *.key, *.crt, ssl/, certs/
   
   # 생성된 퍼즐 파일
   puzzles/, generated/, processed/
   ```

### **파일 위치**
- `.gitignore` - 업데이트된 gitignore 설정

## 🔑 **환경 변수 설정 개선**

### **새로 생성된 파일들**

1. **`.env`** - 로컬 개발 환경
   ```env
   VITE_API_URL=http://localhost:8000/api
   VITE_PUZZLE_GENERATOR_URL=http://localhost:8000/api/v1/puzzles
   VITE_WS_URL=ws://localhost:8005/ws
   ```

2. **`.env.production`** - 프로덕션 환경
   ```env
   VITE_API_URL=https://puzzle.novelike.dev/api
   VITE_PUZZLE_GENERATOR_URL=https://puzzle.novelike.dev/api/v1/puzzles
   VITE_WS_URL=wss://puzzle.novelike.dev/ws
   ```

3. **`.env.example`** - 템플릿 파일
   - 모든 사용 가능한 환경 변수 나열
   - 각 변수에 대한 상세한 설명
   - 사용법 가이드 포함

### **주요 환경 변수 카테고리**

1. **🌐 API 엔드포인트**
   - 로컬/프로덕션 환경별 URL 설정
   - WebSocket 연결 설정

2. **🔑 인증 및 보안**
   - API 키 관리
   - JWT 시크릿 키

3. **📱 애플리케이션 설정**
   - 앱 제목, 설명, 버전
   - 환경 구분 (development/production)

4. **🎮 게임 설정**
   - 기본 난이도
   - 파일 업로드 제한
   - 지원 형식

5. **🔧 개발 도구**
   - 디버그 모드
   - 로그 레벨
   - 개발자 도구

6. **📊 분석 및 모니터링**
   - Google Analytics
   - Sentry 오류 추적

7. **🎨 UI/UX 설정**
   - 테마, 언어, 시간대

8. **🚀 성능 최적화**
   - PWA 설정
   - CDN 설정

9. **🛡️ 보안 설정**
   - CSP 설정
   - 보안 쿠키

### **파일 위치**
- `frontend/web/.env` - 로컬 개발 환경
- `frontend/web/.env.production` - 프로덕션 환경
- `frontend/web/.env.example` - 템플릿 파일

## 🚀 **사용 방법**

### **1. 로컬 개발 환경 설정**

```bash
# 프론트엔드 디렉토리로 이동
cd frontend/web

# 환경 변수 파일 확인 (이미 설정됨)
cat .env

# 개발 서버 시작
npm run dev
```

### **2. 프로덕션 배포**

```bash
# 프로덕션 빌드
npm run build

# 프로덕션 환경 변수 사용
cp .env.production .env.local

# 또는 Vite 모드 지정
npm run build --mode production
```

### **3. 새로운 개발자 온보딩**

```bash
# 템플릿에서 환경 파일 생성
cp .env.example .env

# 실제 값으로 수정
nano .env
```

## 🔧 **Nginx 설정 적용**

### **Bastion 서버**

```bash
# 설정 파일 확인
sudo nano /etc/nginx/sites-available/novelike.conf

# 설정 테스트
sudo nginx -t

# 재로드
sudo systemctl reload nginx
```

### **Main 서버**

```bash
# 설정 파일 확인
sudo nano /etc/nginx/sites-available/puzzlecraft

# 설정 테스트
sudo nginx -t

# 재로드
sudo systemctl reload nginx
```

## 📊 **API 엔드포인트 매핑**

### **로컬 개발 환경**
```
프론트엔드 → http://localhost:8000/api → API Gateway → 백엔드 서비스
```

### **프로덕션 환경**
```
브라우저 → https://puzzle.novelike.dev/api → Bastion 서버 → Main 서버 → 백엔드 서비스
```

## 🛡️ **보안 고려사항**

1. **환경 변수 관리**
   - `.env` 파일은 절대 커밋하지 않음
   - 프로덕션 키는 별도 관리
   - `.env.example`만 버전 관리에 포함

2. **API 키 보안**
   - 개발용과 프로덕션용 키 분리
   - 정기적인 키 로테이션

3. **HTTPS 강제**
   - 프로덕션에서는 모든 통신 HTTPS
   - WebSocket도 WSS 사용

## 📝 **체크리스트**

### **배포 전 확인사항**

- [ ] nginx 설정 테스트 통과
- [ ] 환경 변수 올바르게 설정
- [ ] API 엔드포인트 연결 확인
- [ ] SSL 인증서 유효성 확인
- [ ] 로그 파일 권한 설정
- [ ] 방화벽 포트 개방 확인

### **개발 환경 확인사항**

- [ ] 로컬 서비스 정상 시작
- [ ] API 연결 테스트 통과
- [ ] WebSocket 연결 확인
- [ ] 파일 업로드 테스트
- [ ] 환경 변수 로드 확인

## 🔗 **관련 문서**

- `nginx_configuration.md` - 상세한 nginx 설정 가이드
- `SOLUTION_SUMMARY.md` - API 연결 문제 해결 보고서
- `start_services.py` - 서비스 시작 스크립트
- `.env.example` - 환경 변수 템플릿

## 🎯 **결론**

이번 업데이트를 통해:

1. **실제 운영 환경 반영**: 현재 작동하는 nginx 설정을 문서화
2. **포괄적인 .gitignore**: AI/ML 프로젝트에 특화된 패턴 추가
3. **환경별 설정 분리**: 로컬/프로덕션 환경 변수 명확히 구분
4. **한국어 문서화**: 모든 설정에 한국어 설명 추가
5. **보안 강화**: 민감한 정보 관리 방안 개선

이제 로컬 개발 환경에서는 `localhost`를, 프로덕션 환경에서는 `puzzle.novelike.dev` 도메인을 사용하여 올바른 API 연결이 가능합니다.